const theButton = document.querySelector('#theButton');
const errorBlock = document.querySelector('#errors')




//https://crexendo-core-021-las.cls.iaas.run/ns-api/oauth2/token/?grant_type=password&client_id=archertest&client_secret=90056b1f11f8c87fff30fd1b5acafd04&username=anicholson@crexendo.com&password=Crexendo2022!
var ns_access = ""

window.onload = function () {
    var response = fetch('https://crexendo-core-021-las.cls.iaas.run/ns-api/oauth2/token/?grant_type=password&client_id=archertest&client_secret=90056b1f11f8c87fff30fd1b5acafd04&username=anicholson@crexendo.com&password=Crexendo2022!', {
        method: 'POST'
    })
    .then((response) => response.json())
    .then((response) => {
        if (response.access_token) {
            ns_access = response.access_token;
            errorBlock.innerHTML = `<p>Access token acquired!</p>`;
            console.log("Access token acquired");
        }
    })
}


var departmentList = [
    "100 Bill 2",
"100 Bill 3",
"100 Bill 4",
"100 Bill 5",
"100 Bill 6",
"100 CCM",
"100 Covid Team",
"100 Credentialing",
"100 FD 1",
"100 FD 2",
"100 IT NOC",
"100 IT Room",
"100 IT Room Desk 2",
"100 IT Server Room",
"100 Medical Records",
"100 MM Conference",
"100 MM Conference Rm",
"100 MR 6",
"100 OFF 107",
"100 OFF 108",
"100 OFF 114 DSK 1",
"100 OFF 114 DSK 2",
"100 Office 114 Dsk 3",
"100 RM 152 DSK 1",
"100 RM 152 DSK 2",
"100 Security Room",
"1130 FD Covid Team",
"1130 Office 1",
"1130 Office 2",
"1130 Operations",
"1130 Operations D1",
"1453 4515",
"1453 4516",
"1453 4517",
"1453 4518",
"1453 Cubicle A",
"1453 Cubicle B",
"1453 Cubicle C",
"1453 Cubicle D",
"1453 FD 1",
"1453 FD 2",
"1453 RM 10",
"1453 RM 11",
"1453 RM 4 E",
"1453 RM 4 N",
"1453 RM 5",
"1453 Room 8 DSK 2",
"1453 Tele Health",
"151 500",
"151 Conference",
"1896 BH--B FD 1",
"1896 BH--B FD 2",
"1896 BH-B RM 1 D2",
"1896 BH-B RM 5",
"1896 BH-B RM 6",
"1896 BH-B RM 7",
"1896 BH-B RM1 D1",
"1896 BH-B RM1 D2",
"1896 BH-B RM2",
"1896 BH-B RM3",
"1896 Confr Rm",
"1896 PEDs-C FD 1",
"1896 PEDs-C FD 2",
"1896 PEDS-C MA 1",
"1896 PEDs-C MA 2",
"1896 PEDs-C Referrals",
"1896 PEDs-C RM 1",
"1896 PEDs-C RM 1 D2",
"1896 PEDs-C RM 7 D1",
"1896 PEDs-D",
"1896 PEDs-D FD 2",
"1896 PEDs-D FD1",
"1896 PEDs-D FD2",
"1896 Suite D",
"1896 Suite D MA Station",
"1896 Suite D Room 5",
"1940 Clinic Conference",
"1940 Frt Dsk CL 1",
"1940 Frt Dsk CL 2",
"1940 Havasu CHC",
"1940 Havasu CHC FD",
"1940 Havasu Clinic MA",
"1940 Havasu Clinic Provider",
"1940 Havasu Fax",
"1940 Lab",
"1940 Provider RM 1",
"1940 Provider RM 2",
"1940 Provider RM 3",
"1980 Conference",
"1980 Counseling",
"1980 FD 1",
"1980 FD 2",
"1980 FD Xerox Fax",
"1980 Lab Room",
"1980 Office 7 A",
"1980 Provider Office A",
"1980 Provider Office B",
"1980 Teams Office A",
"1980 Teams Office B",
"1980 Teams Reception",
"1980 Telemed Room",
"200 CCM",
"200 Consult Room 254",
"200 Copy Room",
"200 Lab",
"200 Medical Director",
"200 MM Conference Rm",
"200 NS 1",
"200 NS 2",
"200 R.D. 2",
"200 Rec 1",
"200 Rec 2",
"200 Rec 3",
"200 Referrals FD",
"200 Rm 255",
"200 Rm 258",
"200 Rm 259",
"200 Rm 260 DSK 1",
"200 Rm 260 DSK 2",
"200 Rm 260 DSK 3",
"200 Team 1",
"200 Team 2",
"200 Team 3",
"200 Team 4",
"200 Team 5",
"200 Team 6",
"200 Team 7",
"200 Team 8",
"214",
"214 BH",
"214 BH Back Office",
"214 BH Corner Office",
"214 BH Cube 6",
"214 BH OFF 18 Assistant",
"214 BH Office",
"214 BH-FD 2",
"214 BH-FD1",
"214 BH-Referrals",
"214 Confr Rm",
"214 Cubicle 2nd Floor",
"214 Referrals Office",
"214 Ricardo Rivas",
"214 Speech",
"214 Tele Med",
"2175",
"2175 Conference",
"2175 Front Desk 1",
"2175 Front Desk 2",
"2175 Office 1 Desk 1",
"2175 Office 1 Desk 2",
"2175 Office 2 Desk 1",
"2175 Office 2 Desk 2",
"2175 Office 3 Desk 2",
"2175 Office 3 Desk 3",
"300 Billing",
"300 FD 1",
"300 FD 2",
"300 FD 3",
"300 Lab",
"300 Med Staff 1",
"300 Med Staff 2",
"300 MM Conference",
"300 N. TA 1",
"300 N. TA 2",
"300 N. TA 3",
"300 NS 1",
"300 NS 2",
"300 Rec 2",
"300 Rm 304 DSK  1",
"300 Rm 304 DSK 2",
"300 Rm 309 DSK 1",
"300 Rm 309 DSK 2",
"300 Rm 318 DSK 2",
"300 Rm 323 DSK 1",
"300 Rm 323 DSK 2",
"300 S. TA 1",
"300 S. TA 2",
"300 TA4 RM 340",
"330 Accounting",
"330 Amre Blackthunder",
"330 Billing",
"330 Conference",
"330 Medical Records",
"500 CCM",
"500 Copy Rm 1",
"500 Copy Rm 2",
"500 D.R. Rm 23",
"500 Exam Room 4",
"500 FD 1",
"500 FD 3",
"500 Meeting Rm 35",
"500 MM Conference Rm",
"500 NS 1",
"500 NS 2",
"500 Office 509 Desk 1",
"500 RM 11 D2",
"500 Rm 11 DSK 2",
"500 Rm 19 DSK 1",
"500 Rm 19 DSK 2",
"500 Rm 42 Off",
"500 Rm 43 Off",
"500 Rm 44 Off",
"500 Rm 9 DSK 3",
"500 SCDC FD",
"500 Work Files",
"500 WR 1",
"500 WR 2 Gabriela F.",
"600 Break Room",
"600 FD 2",
"600 FD 3",
"600 FD1",
"600 FD2",
"600 I.R. 2",
"600 Interview Room 1",
"600 MM Conference",
"600 NS 1",
"600 NS 2",
"600 NS 3",
"600 Office",
"600 Office 602 DSK 2",
"600 PACU Recliners",
"600 Rec 1",
"600 Rec 3",
"600 Rm 602 DSK 1",
"600 Surgery 1",
"600 Surgery 2",
"600 Surgery Core Desk 1",
"600 Surgery Core Desk 2",
"601 BH",
"601 Suite 6 Conference",
"700 Consult",
"700 FD 1",
"700 FD 2",
"700 FD 3",
"700 IT Room",
"700 MA 1",
"700 MA 2",
"700 MA 3",
"700 MA 4",
"700 MM Conference Rm",
"700 NS 1",
"700 NS 2",
"700 Rm 708 Office",
"700 Rm 737 DSK 1",
"700 Rm 737 DSK 2",
"700 XRay Room",
"950 B IT Closet",
"950A",
"950A Accounting",
"950A CHC Classroom",
"950A CHC FD 4",
"950A CHC FD3",
"950A CHC Instructor",
"950B PEDs",
"Accting",
"Admin",
"Admin FDesk Parker",
"Admin MR1 Parker",
"Admin MR2 Parker",
"Alberto Rangel",
"Alejandro Sotelo",
"Amanda Aguirre",
"Amre Blackthunder",
"Andres Garcia",
"Aurelia Becerra",
"Autism",
"Azucena Z",
"BH",
"BH 1",
"BH 2",
"BH 3",
"BH 4",
"BH 5",
"BH 6",
"BH FD1 Parker",
"BH FD2 Parker",
"BH Frt Off Desk",
"BH Frt Off2 Desk",
"BH TeleMed Rm Parker",
"Billing",
"Billing Luz Campos",
"Billing ViVi Abotsi-Kowu",
"Brissa Velasco",
"c074ad268494 DTA",
"c074ad268588 DTA",
"Cafe-1",
"Carlos R",
"CHC",
"CHC Classroom",
"CHC Cube 1",
"CHC Instructors",
"CHC Parker ClassRm",
"CL-FD1 214",
"CL-FD2",
"Claudia Jacuinde",
"College Cube",
"Confr Rm",
"Consult Room 256",
"Copy Room",
"Coreen Richardson",
"Covid Team",
"Cristina A",
"Customer Service",
"Customer Service  Babbitt",
"Darraugh Nolan",
"DENTAL 1896",
"Direct to Parker Fax",
"Directors",
"Discharge 600",
"Dr Richards",
"Dr. Bailey",
"DR. RODRIGUEZ",
"Dr. Stevens",
"Elena Rodriguez",
"Elizabeth Arellano",
"Evelyn Ruiz",
"Fax",
"FCC2",
"FD 1",
"FD 2",
"Fernanda Dominguez",
"FrtDsk",
"Gila Vista",
"Gloria Martinez",
"Havasu Conference",
"HR",
"Ilian F",
"Ines G",
"IT",
"IT Staff",
"Janet Vega",
"Jenni Patch",
"Jill Kaya",
"Joena Ezroj",
"Juliana Beltran",
"Julianne Myers",
"Karla Chavolla",
"LAB1 1896",
"Lisa Villanueva",
"Lorena Delgadillo",
"MA 1stFlr",
"Maint",
"Maria Peterson",
"Mary Pate",
"Med Rec",
"Michael K",
"Mike Ruiz",
"MM 100 Main Fax",
"MM 151 200 Fax 662-0415",
"MM 151 300 Fax 662-0411",
"MM 151 500 Main Fax 662-",
"MM 151 600 Fax 662-0410",
"MM 151 700 Fax 366-5165",
"Mobile Only",
"OB GYN",
"OC Johnson",
"Operations",
"Pablo Vargas",
"Parker Clinic Conference",
"Parker Clinic Provider",
"Parker Conference",
"Parker FCC3",
"Parker FCC4",
"Parker FD Suite 6",
"Parker new office1",
"Parker Sign Desk",
"Parker STE 6 RM 1",
"Parker STE 6 RM 2",
"Parker STE 6 RM 3",
"Patricia Robinson",
"Patricia Salazar",
"PEDs",
"Pharmacist  Main Counter",
"Phillip Gladney Back UP",
"PK CL FRT1",
"PK CL FRT2",
"PK CL MA1",
"PK CL MA2",
"PK CL MA3",
"PK CL MA4",
"PK CL PROV2",
"Prov Rm",
"Provider",
"Providers",
"Referrals",
"Refill  Babbitt Lan",
"Refill  Medical Mall",
"Ricardo R",
"SCDS",
"Selena Bonillas",
"SLWIC Adults Marisela B",
"Staci Page",
"Telecom",
"Todd Minkey",
"UC FD1 1233",
"UC FD2 1233",
"UC Lab 1233",
"UC LAB 2 1233",
"UC MA1 1233",
"UC MA2 1233",
"UC Prov 4 1233",
"UC Prov1 1233",
"UC UpStr 1233",
"VIP Mobile",
"Yajaira Gonzalez",
"Zamantha Wilhelm",
"Zeenat W",
"Zelenne Esteves"
]


function pullDepartments() {
    if (ns_access !== "") {
        for (i=0; i<departmentList.length; i++) {

            var request = new XMLHttpRequest;

            request.open("POST", `https://api.crexendovip.com/ns-api/?object=department&action=delete&domain=RCFBH&directory_match=departments&user=${departmentList[i]}`);
            request.setRequestHeader("Authorization", `Bearer ${ns_access}`);
            request.send();
            console.log(`Running department ${departmentList[i]}`);
        }


        request.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
                console.log(request.responseXML);
            }
        }
        
    }
}



theButton.addEventListener("click", () => {
    pullDepartments();
    console.log("Button Pressed!");
})





